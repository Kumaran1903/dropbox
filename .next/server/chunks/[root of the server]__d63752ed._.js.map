{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/kumar/OneDrive/Desktop/dropbox/src/app/api/upload-url/route.js"],"sourcesContent":["import { S3Client, PutObjectCommand } from \"@aws-sdk/client-s3\";\r\nimport { getSession } from \"next-auth/react\";\r\n\r\n// ✅ AWS S3 Configuration\r\nconst s3 = new S3Client({\r\n  region: process.env.AWS_REGION,\r\n  credentials: {\r\n    accessKeyId: process.env.AWS_ACCESS_KEY_ID,\r\n    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\r\n  },\r\n});\r\n\r\nconst BUCKET_NAME = process.env.AWS_BUCKET_NAME;\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== \"POST\") {\r\n    return res.status(405).json({ error: \"Method Not Allowed\" });\r\n  }\r\n\r\n  try {\r\n    const session = await getSession({ req });\r\n\r\n    if (!session) {\r\n      return res.status(401).json({ error: \"Unauthorized\" });\r\n    }\r\n\r\n    const { userId, fileName, fileType } = req.body;\r\n\r\n    if (!userId || !fileName || !fileType) {\r\n      return res.status(400).json({ error: \"Missing required parameters\" });\r\n    }\r\n\r\n    // ✅ Define the file path inside the user's folder\r\n    const key = `${userId}/${fileName}`;\r\n\r\n    // ✅ Generate a presigned URL\r\n    const command = new PutObjectCommand({\r\n      Bucket: BUCKET_NAME,\r\n      Key: key,\r\n      ContentType: fileType,\r\n    });\r\n\r\n    const uploadUrl = await s3.getSignedUrl(command, { expiresIn: 60 });\r\n\r\n    res.status(200).json({ uploadUrl });\r\n  } catch (error) {\r\n    console.error(\"Error generating upload URL:\", error);\r\n    res.status(500).json({ error: \"Internal Server Error\" });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEA,yBAAyB;AACzB,MAAM,KAAK,IAAI,iJAAA,CAAA,WAAQ,CAAC;IACtB,QAAQ,QAAQ,GAAG,CAAC,UAAU;IAC9B,aAAa;QACX,aAAa,QAAQ,GAAG,CAAC,iBAAiB;QAC1C,iBAAiB,QAAQ,GAAG,CAAC,qBAAqB;IACpD;AACF;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,eAAe;AAEhC,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC5D;IAEA,IAAI;QACF,MAAM,UAAU,MAAM,CAAA,GAAA,uIAAA,CAAA,aAAU,AAAD,EAAE;YAAE;QAAI;QAEvC,IAAI,CAAC,SAAS;YACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAe;QACtD;QAEA,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;QAE/C,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,UAAU;YACrC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA8B;QACrE;QAEA,kDAAkD;QAClD,MAAM,MAAM,GAAG,OAAO,CAAC,EAAE,UAAU;QAEnC,6BAA6B;QAC7B,MAAM,UAAU,IAAI,iJAAA,CAAA,mBAAgB,CAAC;YACnC,QAAQ;YACR,KAAK;YACL,aAAa;QACf;QAEA,MAAM,YAAY,MAAM,GAAG,YAAY,CAAC,SAAS;YAAE,WAAW;QAAG;QAEjE,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE;QAAU;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IACxD;AACF","debugId":null}}]
}